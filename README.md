# Geospatial Analysis of Police Lethality in SÃ£o Paulo

<p align="center">
  <img src="images/police_lethality_maps.png" alt="Population, raw deaths, deaths per 1 000 inhabitants, and LISA clusters" width="800">
</p>

**Authors:**  
Luis Ramirez â€“ @lramir14 â€¢ Monserrat LÃ³pez â€“ @Monlo â€¢ Rodrigo Dornelles â€“ @rfdornelles
**Last updated:** 2025-05-12  

---

## ğŸ“ Project Summary

Brazilâ€™s state of SÃ£o Paulo reports hundreds of police-related deaths each year, but the *where* and *why* behind those deaths remain poorly understood.  
Using 2022 census micro-data, detailed shapefiles, and incident-level police-mortality records (2013-2025), we:

1. **Geocode** individual deaths and assign them to districts.  
2. **Distribute** census population and household income down to census-sector slices that align with district borders.  
3. **Map** raw counts, per-capita death rates, and Local Indicators of Spatial Association (LISA) clusters.  
4. **Model** lethal-force risk with spatial-lag and spatial-error SAR models, testing demographic, income, and urban-form predictors.  

The full workflow is scripted in reproducible **R Markdown** (`R/PoliceKillingsFinal.Rmd`) and documented below.

---

## ğŸ“ Repository Layout

```

â”œâ”€â”€ R/                         # Helper R scripts & functions
â”œâ”€â”€ R/PoliceKillingsFinal.Rmd  # Main analysis / report (this file is the source of the results)
â”œâ”€â”€ data-raw/                  # Original raw data (not tracked by Git LFS)
â”‚   â”œâ”€â”€ MortesDecorrentesIntervencaoPolicial_2025.xlsx
â”‚   â”œâ”€â”€ SIRGAS_SHP_*           # IBGE & PMSP shapefiles (districts, census blocks, favelas â€¦)
â”‚   â””â”€â”€ bq_data_income_setor_censitario.csv
â”œâ”€â”€ data/                      # Clean, processed data (generated by the R markdown)
â”‚   â”œâ”€â”€ mortes_policia_clean.rds
â”‚   â””â”€â”€ distritos_pop_2022.rds
â”œâ”€â”€ images/                    # Analysis figures exported by R (populated by the Rmd)
â”‚   â””â”€â”€ overview_maps.png
â”œâ”€â”€ poster/                    # Conference poster
â”‚   â”œâ”€â”€ final_poster.pdf
â”‚   â””â”€â”€ final_poster.jpg
â””â”€â”€ README.md                  # â† you are here
```

---

## âš™ï¸ Quick-start

1. **Clone** the repo:

   ```bash
   git clone https://github.com/rfdornelles/geospatial_assignments.git
   cd geospatial_assignments
   ```

2. **Open R** (â‰¥ 4.2) and knit `R/PoliceKillingsFinal.Rmd`:

   ```r
   rmarkdown::render("R/PoliceKillingsFinal.Rmd")
   ```

   The first chunk automatically installs and loads all required packages:

   ```r
   c("here", "dplyr", "tidyr", "readr", "ggplot2", "sf", "lubridate",
     "viridis", "ggthemes", "spdep", "spatialreg", "patchwork",
     "janitor", "readxl", "stringr", "broom", "grid")
   ```

3. **Outputs**:  
   - Cleaned RDS files â†’ `data/`  
   - Figures â†’ `images/` 
   - An HTML report mirroring the Rmd â†’ `R/PoliceKillingsFinal.html`

---

## ğŸ—ºï¸ Key Results

**Download full poster â†’** [`poster/final_poster.pdf`](poster/final_poster.pdf)

---

## ğŸ“Š Reproducing the Spatial Models

The SAR models use queen-contiguity neighbours via `spdep`:

```r
nb <- spdep::poly2nb(deaths_map)
lw <- spdep::nb2listw(nb, style = "W")
lag_model <- spatialreg::lagsarlm(
  deaths_log ~ pct_parda + pct_preta + pct_masc + avg_age +
               pct_pm + pct_favela + income_per_capita + pop_density,
  data = model_data,
  listw = lw
)
summary(lag_model)
```

See Section 6 & 7 of `R/PoliceKillingsFinal.Rmd` for full diagnostics, Moranâ€™s I on residuals, and coefficient tables.

---

## ğŸ‘©â€ğŸ’» Contribution Statement

All authors contributed equally.  
- **Modeling:** Luis Ramirez  
- **Visualization:** Monserrat LÃ³pez  
- **Data wrangling:** Rodrigo Dornelles  

---

## ğŸ“„ License & Citation

- Code: **MIT License** (see `LICENSE`).  
- Cite this project as:

```bibtex
@misc{ramirez2025police_lethality_sp,
  author   = {Luis Fernando Ramirez Ruiz and Monserrat LÃ³pez Perez and Rodrigo Dornelles},
  title    = {Geospatial Analysis of Police Lethality in SÃ£o Paulo},
  year     = {2025},
  url      = {https://github.com/<your-org>/police-lethality-sp}
}
```

---

## ğŸ™ Acknowledgments

- **SSP-SP** for releasing incident-level lethality data.  
- **IBGE** 2022 Census team for open micro-data & shapefiles.  
- **R-Spatial** community for `sf`, `spdep`, and `spatialreg`.  

---

<sub><sup>Questions or ideas? Open an issue!</sup></sub>
